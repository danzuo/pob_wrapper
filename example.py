import base64
import time
import zlib
from email.mime import base
from pathlib import Path
from pprint import pprint

from pob_wrapper import PathOfBuilding

TEST_ITEM_1 = r'''
Rarity: Rare
Hypnotic Circle
Opal Ring
--------
Requirements:
Level: 80
--------
Item Level: 80
--------
Your Meteor Towers drop an additional Meteor
--------
24% increased Elemental Damage (implicit)
--------
+48 to Intelligence
Adds 21 to 40 Fire Damage to Attacks
+46 to maximum Energy Shield
+15% to all Elemental Resistances
+17 to Strength and Intelligence (crafted)
--------
Note: ~price 4 exa
'''

test_code = 'eNrtfWtzm0jW8OdHv4Jy1bxfojh9B_Im-5R8SeKZOPbYuezsl6kGGosJAgWQHWdr__tzugEJJJCw7L3V7kyNRxLnnO4-fe59gFf_-30WW7cqy6M0eX2AD9GBpRI_DaLk5vXBp49vnjsH__un0atLWUwvwqNFFOsrfxr9zyvz2YrVrYoBDwFeIbMbVXyuadHf4be5TIqpSpNz-UeavU2D1wcf0kQdWJ5Mgqiov_mxzPMPcqZeH3xUs3ksswNL5r5KguPVlbPk2yLKoyKFizMZJdep_1UVb7N0MYfBDqzbSN2dp4GmcXV62hg6SppDw9z_59VlLO9Vdl3Iwsrhz-uDCbBA3qh3UQGEZLwAKty1BXYOBUaCIIwPXnRjXs-VCpZI9BC7pA8UqLeh7UPeB3uZqdMwVH4R3arjLCqOpzLx1RLTdQ45plT0oe-Jcr6Ii2geRyprrIj1YXxMCxmfXF4vYRlzCKbuIbddwZGzHS9dsRr1QX6JiulRDCzbY5SzmyQqVBORUtdxDxHiNoVNtbcNuonMOBaYAA8dTh3sbkO-TKM8TR7BmD0mfbyIY9DMJmYvV4_TmRcla0wdtrxrJePjNI2D9C5ZDXQoxDaEc_l9NU7v2qOZAkANny-hyaHoRZhkSl6EpZJcySBa5A2e9SGdy0Qep3lDy3tn_j4KVQuU9Crr6XULsJfxV2BihkHqeV6qDExgMQxBz_ZBCNUI18pPwcw-ZIyHoDTWsd9ge2CeXu-DsMdA18XKTBLWq5pX6lsTEvNeOTpRK0XBgm4h2ILkvep6ljTE1902wybk1hnepgW495VXQVuN2em7yyUouFG3V5svp_d55BtbEc0WM3CVH-VXtRrHEVzQQ_jDXQc7_UJzMy0SsIN9ZBglDj50iENcF_Wy7U2UqcdROAYT2UeBY5c6ECdQlztuvzMA953mfTQwQ644JBxj13aEu02JGjNndEsU47_U0GeJvxqE0G2EPyWZylV22whoCLa3olyBdulIy4vVYJzVMJWWrhiJDhFl4K8otXm_zJYD36ikGv1-mPF5r5Q_fQuB5pUsVEMOISTcZu0a3ENiK7s1dJPdDG-j28FtMRBhg2-HiDuIUYxtm7Gtq-nmG8b80N3m5Axaw5RtG6Kbz9vNykmLvgOqwLdHqR9U0Z6T45BD4hIizD-9lhHwluKze24AvWTaMGYBxmmispv762mk4qCNaQtxSHfP8YvMggFOrjHMigtkEHwtAMdyPgTVSHcTvynlAwfsFDshyKFLK4bYQwg9ULhOb2Xe9G62u91iVvCD1neuIJEBhECtJWaoPwdM_9AZYPwwtEk2SxeNyMRG_U7GrKJEaJkisctPn8iZ0fNg4bfiAafXDB_FkLCvrcHmWyYWxw9DmRSF9L-epMHNYFaZUR6Ocb2Yz8G46q0fiqdDiiuVR424sn8lK-ALUICm1lG-LeJYG8BBu4HXByC7Y6vBy1jDeMBadOizNky_uWlArw_Rr-h1beUcTMwMnKMpzJynjVDm0HEQ7t8iyLcHJdsGsJ3S9yt8egfzn-o62iqZtYdAN1PsXoQ3mUp-3K_TR4PAmwPQfssbLDKtD-tjsKEYXaUCXRmIQdtOZCGtXMnMn76HvX59cND49kbGsQfqD79qrFcvTH1SfzqbzdOsMD8ey9jPDc2zZL4orMQUFmdR7v_uLcJQVw-BZpGZ4ufpmzenxx_PPp9W02ii5F-jOP49Wcw8XSkr_7_iy7UyNtHKF15efnx98DlSd9ca60QVMtIlDj-NYznPVfD6IJRxDiNH8NHAXMN6_WILNQMFSUFphftorQD6KZ1-V1kB64Ugws8i1Tuv5fUdkyoH1H5bb1sfNV386ydUGvJjmRel1-7hlCml9lPR9cze5eiLW3BBZmTcO3J1dQcnivu5ysG9RmHka4nfvuUfAbqE2sIX3wdl8e-37HfljvppmGpqH4HyYj9yWdjsw66ubuGqKar2crW82o9-onzZu_byYj_yMhBME1Pk76ayhNpC6UOaGCEHpZlEsfYdvTt7GqslSD_Bi2KqstIh9VI6BxtVg2xVnCzyFkW_GjcgtvDKVA16OKSv9aOWGXDPGvS1LZaolaD0MLQJ00-qzIh6Ddk21Dp47mFfeXXLIuoEomf-1eV-AmUc07t_VVC0Tb8hZO7Xb32xH7nUj00SRbYYSMHI8okKFVihrcK8hNliRYtFcgIGr9jC0IGkSq80uU2joAzXH0XNLLKb2IpTD6JVGolOvj2YoklnHsv6tSznSdhfVTB77HcDZAchMLzvtrj2YZSWCcA7JWN9ZJfGjyO4Ual91DrTIpdJYMpcgxf66kUd374yIUVu5RD4vlWz_Oge0o832miuHf7NZAH-Ts3e62P8j6kOwqVfqOx9eaxfDSYNo6rIFOJufNCmXAtpoEK5iPXvvy5kHBX3Orlo_FpRhUzOyqfpnZavkowOfnKwru_fl1cmcVFR0GPU8yi5Vc3CcACb36ofTVPAZDVVwwwz2Sjx40WgzpIqaXt9kESx7nPQdeiliuVxCmt7G0Psmh-sE1uO9T-vYEoVKsB6MiZLAhrwPEpgB9cm0LhS_Tj5HuWnsEB1DZl4pLJ3KpNxcBGalPmgbqsg-KA1FG4NdaZDvgrvcgEB7f3mHMzw30peanjgrMoSiKrh5xs10z-dQ0ISQGr14qwAZr_QHH-xTvZbvZ8EbfDNTxdJKRQ6N9IFpXpaVhpaHRPbtfoXuxj9YO5M8mmLCyelSG5lgWEffOqisQcfNPrghaFdC7tUEMaFkQrAH-uaxZ5r6yEzeHlLfKsk8HQLhCxZZbMoqZz_nuvrpmKs0oDVtbHLtb0qaT-52fmi5Bx8ANnL8NRNWLuYWhlcnVhfJC2f_FD-Li13P62hXNYUrLupSqySitXwjUMWvSlKlddaLvuzlPF5CoYvuZ5CWLO3NPXRGawumoBVUrBKEk-nMG9iGOZEPsLQbVIYuoUG0zKoD9QS8jAtOUqDe6vO0DYUhRw8mePQO3UUy0B9BjHXrRZdPDXQlzIrTPvhQAHqotopQEvqFavoFpkyRK2K6lCZ4gPNxackVrC1l7FusNrbUHRRGSpfkzttEsDLVESeUG2qCTZK6ReJqQ12Bk1k4GL7yQ13rZqEVdKwLhJLU9Hnbk--vWeJnwFTVdDsp3vkZu-mOZgPy71f0rQ0UR1SlWQHM0QMZMgkCFSgT-BKf_RIVmyj9nAmGGqWJmc1K_sDVs-Grz7S8Y6MTbb2uJV3Uhqq9aezudaBv3Pg9U7FM1U8Jux6OGer3PZJeLtOazB3k8ZJwZOY0iOV5Sr7upflrBzkOonBClIjPt1qJnku8zxK8nP5uDXVhhsi_K-JyvfR_moq_w9ShPz_55aZ0dOt9Eon3Spd5NqsPGal3YQGL3OJbuzb31ntj9K0yB-j9YNDi8kik6sq9mOiipPoNkrUkT4Kj5KbhzO4xLeWBJ48ijLdQCooz4Aes9IuQoOXeZbk8yhrJu1PUkqCNFXtX0RqYQ-10SXWk2_TMpLaLpb4ocHeBjmYEx24ZXVst6TxDym34EdZgJ0yo-9lU3lRH2nuKTvdVIbKUIVtNc9Mn1KYTOHvXN5E_uOkqIPOcAeZZenNw6KZ3RWAqNgzSKuT_XUCQ3dsifhAFTDS3qMEsfT0svW5zSLz9c2UMOGX-OUvMp3VYcU1WM2oGFsfYfzEeithZrHSTvJh5yR6vP5dKGczsF55mvgQpBb6aPQiNDWO_EJ3b7AhPDUjrbi6yc3q47UqzNlZeWSmP37MlKrPvAwuro6e4EvzttQzcwIFHAArnd1X3RmvD_5KXYeKMaGC4L-N_8ocIuwxtfVHzDAfM1swAt8oswkdM0SRvkY4p3CNl984YYKMuetS8TdYRRro4zGbOs6YujamY8JcG40JcclYCP0DFYIyGMV13TGD4cm4HBdjBEiCMQIzQg4lY5vaAIhtBGMzF0CIwK4AAhjZY-YiB40FFy4gwWyBGCaCjqv5YAJDcYG5o2EcGNYVzNFTAFwsXM7GxKUcfmcIKGAHw1jMsW0H_jJYLbYdgsfUcZEZRQAuoWiMuUvHAlDcMSY20OXI0ROGpcFCYMljTBFy4WcOyy7ZKCh3xyUPMacCeMdgBnpNDMMvGMNqKCxPINgP4AzQGnObEDKGCQIHbaI5gIHAmHPsIuCJSzH8LgxdbANdBhswJtiF9TLhYpgoZgT-EhgQJkOAtZgzxMccLjP4LAwFLjSHHVtP0oWZcc4cPgYuww5r3gr4ayMBdBygAGsF3hKOheEq4AqOzGYyB_bFAdbDHJjeZMdBZp0OwGgc2yXu2IUNhDURqjcUBACmgYAIFratJwbspVTPS-8Y0vIDayUuBkC9b7BjmFK9GyApY8fV24k54Vp-sF6GFiLgN-BT4OS4lFNBNCLiBDgLK4edgbnBmAjBQJzCxOAz0VttdAGkgWgyIM4wGQYEsG1TzRgH6FBYKQI2MNgbjDST9C1WQq8J2MNcAmIlQAAczU4bmAesBb0rQE0bN5tjt7qPXKslrw6GP129L23RtCjm-csXL-7u7g7nspimofoexerQT2cv5jq7ulXPjd15rsm-mMA_RzefjtTVD392_2Ya3fyB_vj-7ZNn__h2e5Znny4X3z59mfg_kts_ZyKYfT5D72_tP26FOL39cWGfnQRgXxdHxxfJL_Ppx5_f_p6JX26vgzfJX0L09s1vby8Uc8_V72-j2fS302t0j_wvv6S-_xtm6o_LyZc8ks8_XNyhq5Pnt4uv92E4vaEf5NeLaPJBfQnfF_kx--xezN98_p75z9__fHf3_Pzq7vKYfp7_gS6l-O7c_J4E5D0-z3_8_Nv3bzz6dMl--ToTn_8SX8Qx_5LPJr988a6-fn3_22ya3YL8nb599-ajPPkzLxb-jfvx0y3_dHZ77Xy--R5-QCG5JBe_vz35_uv5z0efUXKXvHcn4c_PiZf8_Ht4EUfHM_T5HQnvT36cfyS__LaYnJ8lv9299W7DyyQ9vrn-y-SXs8nXu-uPk7NfJ-nk-NvkbDL5Orn-9ehmEt-e3X47O_-xWEy_Tb9z_GMqLu6ew3h_Pv3iJZPXr0uzXe_kq_K2_7xyMeU3YyH1vhu7CF6wKP0zEcuIYA3Q2MsGIOkDNLahAcj7AI2xaADSPkBjb1eA9b3Wm4DGGDcA7T5AY6kbQ6NeitqYNwBxL0Wwyo2RnV42asvSAOzltzHOjZHZyh-v9hO-gIs13lj7YP3hQ1ooc03_WH8xHlo3VFf939dFpmObH2k6-81EBLqH5J2SxbmcV4GAvla1n9Cq-6SQxUkETjsz3Ut19KAB_1w3xb8ycV0VC-jPdfvLIlfljcJlImF-bjSpaNBmg8qV1E0QL61PH85-_XQ62oy6RmtB16g85Hppga-qPh9BflTdyAeG66WFDl3XsUefkujbQllnJy8th4QuUtTx_dBThLvKZ7bNPNsLqIMCiVAoHeaFIQmIcqkXIMltx_GUsj2JhWIjM23DJU1sVJUWX1rEHlW79NK6em7-HRmwK_XtpSXc0dlsHkd-pK-T0V_9TIaFCv72MYtubvQhRjqbySTQYZwu25eBnAXpF4Ryo2fo0KY_WUVqmZ6z5TmHBZsafVVW2dA8eiaIhpmVTVaW7kIdPSPIIJpyeNkYaWDRIbN_Mr0n1b1KVtlQXh8wmyZfyDVlXtLRf6z6ZjMrzNKZZe4_U2UqakU5iHFhybl-MEYwWl5TFrb0zY7WHBaZG3GwwjSzlKEDvtBqU26CrQ8yOk6zbDEHthmtOE-DK5kA6Uz_1U9Y4AeVQFV60wtBdkLQnRBsJwTfCSF2QtT3qZjsqa03pFNvTkClp9bVIp-OJjNVwO4W1lWU3DSVIHQDFgRg3D2Qcs-mPkRaLkR9AfV8yUPmO1z5IPMQhtlBoHwVYkWkD0EWhIhKobYSoIacU9SUcwziZxvxM7cfNeWv1pVRtfMWN9JohAHE6ReIMka609aaBGB7QMcSZeSGVtJhdEPHIo8VhcEb3bUFtHMLJuoG1GGyyNJMjmDls3lklgTKUFYYlpYLQzi9xXS57qhs5q7wwHIwMmr2d69j4eY2YyV9G3sQ6gZOaNvKDT0_ZE6gXAkSgJQTOsSTCkwdx9IWnmRK0jB0Q5t7VIBxa20zb9g61LZ1R01LR5oSgEbg_H7SGffyXFIv1gJTZ7WWNnqGS0Mlwb6dxuZ2MzBKK4nJR8_4T03zpm_Pa0rUM_FTZQg1lOnBXgpXayhL6cRYAxEjc9WUTHvNfbqoULHdnPZqRpV9vItAyyqTWWbF_x42SfQLM2sL89Xk6nT0JVXWL0rNR9fS111sfgQseCszbynC3BE9EoxHVSd_CVR96YBqizjoxFYRB8UAj92Uc-rYkC5BUiR8EGNfuFQ7bhs8N_F9F-FAYhdyKBB93_EJDQPHlmABieLUowAyup5K7Xc0J1oyD-6pW-jfPj8y_7advEPWjB_WQmauaznTkm06UcoClS6ErYOUA2g1MdFUC7I0pNV0dgBTvqlzY6vagS7lo6XyLW9GbSqW06bV7CvQGzWLIFDReqNttjWVMBNpUfaT5S-V8fT7PIYYd2wFSlvyGwAoYDunmlAxVVHWill0zLGMSkp1Az4dMrw7AlqGVc9waSyMkdDrXXdA-X9OCOHshHD7jQLv9HBns1maaWv4JlYQaLzXMQco0JGKi6ZiEsY8jwQCFM7lHg9BQ7lizJeSYBVwKRWDoNtxlOdwSSnnwpZ2KAhx_IC7nLcdEG2qWlPT6GrfMe8XVrDwYECMqBopnWS-hKjiepGBgGkFWCGWy9WoZXITpotEuyi-w0Uto5pnOrJdj8UbQTFl-NAppX0V8TYBnENh6aO95uXnZNf4z5m7rjpWodtiymC68lf6xpARQx1uueSQDuTLGw2DsfUmS38APoRe11O9uuBfKwp_whj7KVRoGz9Qv5aJDtcLWwLbFwRgsD_eRVk8upQLuRHKe8LnBNtKMSERk4EAXxiKkDHQLCoRhxgSnKMH-azveSFE9BD2EUSdUCLlYcn6Q3nB296sjMYbOlNlp2UoZMwyKMC9fp4kCCTI1Gq-S7WYBBC4Uy3D9qacppV8gq8jxAh6eeaxYexXD2CEmNDZpmb8kG5o0TNOOjNiXGYgLa3R8eNi3kiDV4amFR5WXurfKaP8J0q73SHtR1maBtY7GaejyyydT1UB257eJasij4v648x2BGmL4TkSY0hCVusFinjctz1CHcdnQjigT8zlKhBcBC7lhFFwTTYn3PUF8hhyfR-RwFvXn55w8UqHiw3lslFPPajth5o9y8tj_yporO6ls5pNsGsK2GIkxQPzMNrUqLWLrrtZYcKi-ZtWN4gneaeOPWNsFZY1fyduf_z5d_cy_yl653TqnZx54PM_6SDovbrR-YHp-1rVKFwyVPEYGq54tsccwoKACgV6hBgiuiBrE2EHyEMQCwYC3FnoBoQzxyWO4D51XY6FR12PuHJQceLLc_1vM0ezSU_k2PAaZFWKapQjo9CEjqBsyrg98A2wsPh-1PIEVTWzURnVJEftsLS8l9U8m2P011DfTbrIYAoED6DUGbd1qDET3ZrGnH5Naxuf-qk_1USxaF7U952bYU21ZFm_HWHaTPxudMxwkeSxXMBwpoDHmgU8U-ZbJW32Zsz8n1bo_QeZh20guN-CuB0W5DwCAQYL8jbVTzYf_aw91mS2iFUrFQxCZQvpQwYIqRgjXDDBXRoyHFLlO25IEVWuQooGkPfZLvwiVYgdD2Jah4Y0WFf3vji14UonMYgmqExunSXhQgttma0-o8ZhnajvhdLraGRtBNf51eoZIPWxygr-GaMbcmqiY4xWVkNXRu6NgKugqxK0DH8bZZtVdIm31FxWUGIDakgg-l-XOdxlwrUOn6n07ZhHkB-PrtJ7s4VKJq3Ku4uQT7BuSPFCwYnPA8p9hH2hqHSpQ13pSwd8WigYFg5moetK6sBvkmPu2f1RpVg5t_XyY69rq2uGQarKU7paaDbKbEuUt8CkIre2iKERcojmKuK9lUCdVj1lJbAZ4Da5L1jLPZkq4bJ4uKF95fX-QmxbQ9eBjbKX6eKHNHle1harxBGmDIYik1bz1xVjj2VScmYx1wNSCM7NBfC2gb5LPGtYgfrwbHcavERpMVvz2DpJFzq--0cZhn8VtX-ko8PdTQlHaVHE2pHIqJiOrhfxfArR15tY5l9bdc8AYyzD0A4kYZJzT7s2VxHiUlu3E0Bc63HPdRzGfFtgn9mOIj54QCwIwZL3xrato9Y-v_dJK8DyNEuHqlIXNJWu4VWTNM5prENac2gfg9YE96A-lipdzDH8oB3ncZpAtKbjzsDSLxGBeA-iNhjAVEuy8g6EVWLaAe4bSoHl3YN-R3nJK9CA3PqYgfCaWqt-LcE23GChHzZY252yxSC33M0CTFW10XamtEYjzFrRefexgSV1nAomvbZhsMaO6VTTKFdQMeofdV63X4cAXmsROJ-8PTseXRcyM1Jc3etiLG25qtIKQzQ_U8F964gtcDCSgRdQ7EkkPcjZwGcFLgqw7yovlBDQUQQQSEgSYhEw26YOspnWAM8WLYm2cStba4RyqH12rKsCtZBNZrpluU40IKY6S3TWUqxaR4zIw9a9T--qmKx0Ymez2SLR_g_konz8nklE3GUiAmqwKHVGV79LkIHV7U6u0y6un0gP7HBWtzT9uoj8r3kU69PpFu-Pp0oVctrqWVJYSuZSgjzPs0MUuCHmiDkUvrKAIJ-GAhJpR_gQd_iQNRPmE6YC4QvHUzzccqbpNLnvtAu-jdTYsEcWZoIqCcq51tpcL6lSCeJ0WAbSSoArSEz6081_jrbxLbvKunYVpncDwQHIWc2FZdNNa1cvsgDcdLNuHyCuXOZ6iAc-Rh54BQgNAzuAWJFQj3KkbN02bSvsKUy4ChDTkAT0DULFcFv5o7GlrGdLVz6iKhzClkl_aoWLuu-GLq8sXYmsKh9gyyGKMT6ks35CO-snrQ09fcoN7dwu3mn69KNGgVH5cru0jdCNOa3d0kcvAUR7aXPH9Jkl5k7ggB6CJUQecgWHfNVRwrdtRzfAu4Huz_dpoFNXGzJZ5CMXclxGQUsH7pi9z47pws1a1UVWS6qejrDcRBMUynVPOOJuR1npwTq4bUNEZ0T1Js28KAhgcuYBKRB5RDNtoX9WdypueSAM2oL1sbDnhdgLAkifGIRRbhj6FDmCUm5jBm7KCUMkVKgLB4RzKXmgj7vWFEaMgNuLKNMxju6Ht6pXqrX9z6qCAOHAbVSW7XTPpCm5VwVBE81rqTHPidP8mlWhvHZGzfXp4sPDDk87Gdl1fPIuTfSGXc9l9nV0riCimsHCFvqmm01WMuIFvkBOaPtEIs8JfEaxRAp51AsksNXlKnSp6zNCJQVPj8D2hODm9Q0xNgrWe2BX0stZTwpqDv6YdVneRVB3TK0qGdVDG1rXdU-pLGdf9bq06Oksb2bytBZR60Z7fVCdlnM5WmSm2FmlQVvQZZynNY1ntLt5cSg6a9eNelf5WccdVyoCGbtJK4_ZC_wlgwgYLkS1yvy3F9Z033dZl09JIguIQWJLR4sgDsXoc5RFQSQ7LAxTjEM-poh0_IB4PuICK2ULDracEQSOmivEQ4ho7UAoG2yKdDzq2_AfQw7ZaJcsE5uXpZx0G5YeIYKtLZFLSdJJmjYsdUCrMbw0gaAs19boUyIHknsiUencALdzA75om7iKek_v1egyi3IwlZG_uQNCCmQThgVGENISgTGHnFl4JJBcOsj3mOt6PuO6U5kQOwxdjyibCpdISJ2pvb4DLZ63iqXdx5u8C8SkEqzrijnq7EgUtVcoc9cqpZDGdZZZ8F_A_6YFpCu-NBuoqpwTLIXOXi2no6_gNyBoLnKxiq1PTZWpSnxNe8-aT887Rm89ru9fyHJ09rej7t4z8-gCfUCmpDHq_TGDRzFzAx7oIJthFEJuKiBcYDT0fdfjyAupEHDN1V3wyiY2kwjCcB8APY9jvl6G3aLR-pWW4OA-pIW-zxbSgKVKLrVvbH2pgzBTIK2qMjMQINiUsblgQjestRrormqCJmElqM5Y-xiGd4ZYZQjiybjY5JZ-hyukHgx5bqjcEBIUxyXYdpECdklEuef7kInqvlrbhVAsIDQMIfB1PILoxonsPyXCMhHkoyMs0n1nxXkUR6biUFb_6jdudJixIMC28pTrCRHov0Ho2RCnCgIfICmXkOgFEKXaWEEQ60HC4FFHEnA-ykGK-BuMrMTuvY7k2_w7lvrdZSboj9MsCu8txyaOlag7K9SzhOzAApG5VVllAN5FN9N6K6yTFEwBuIXKXxhPkZWOR0smbAksKaurd6rGy9vmsHHwZPI9jKz6DYgjvLJXpg9LvzPS9C6Xnmkd_B1EWLAM_98qpukUIdp1Umok1TIOcPTufg5uHbwg-MRNEdI3GjOQFiII8onrKI9LLHwkPJt6oc1CHZh7kgQBQrZyKWIYkk7HhzjEdgXe0jnbLgmQdnd3z0lD1V291KzySbbgwRJdPvYUUAiBor6SGgOn-19bsa9pFThLChXH0Y0y7XamcY-QKsyt2rp1t0J9h4VxXnfaMZcHRR_vUusd0AHo8o5CPfe1rPdyKvVje3o6DZ6sc_XvLT1dt2Icy0L68X0-s659MKO7kjyFpMukDHSR1sOOZCBSIbeZ0AVc34P0jyDm2q7vyoDAH_jiiAD-F3geCZHbkiDh_IsmeajvBHxoilb2gnZ1Uw8l0Sh8oUPM27Wv8gbY_mTuXN4kxpNtSQ71YbPxh__N9Mqbyzd143OkmX2c6T4l4yX79QLyORa4PvewBxmGkD4VCNsIhyJ0XBeMKXwOEKR4NMA606C-h_QNwODKvdDBrN-ybtcLp1cvSNfOlx64qRf5_tWPxrMwh5c-TEN2uxOmV0ZP0uxeJlGd5r2HsGhbCWOVAr6DGL7oB7yepV_LHjX9CJ38vwpQPq9hUwFOFvnXKrAot7ZX_h3lQNxpqzB0qA1-wfYlhSgUwnmJJKWUONSzQ8p8xwePgUMUcOS6oSP1ffGMtP2CbTfl3-lrxNLyT3rlf7c0t1J3E0dembf2lm2Rp6G-LxGCivtVZPkwMV-V6AZX9vrdRq8wf0r8dDaHRD3SIcq_a4h7Haf1C_5WD4hbPtuibqUyUOUjIeqHRpQ45VlC4_kay7dHNgjXz81awmyC6FvNVgB82LC8QZJu0qwfc1vD2MOoNtePh6E0nqqCyTAU0kBhm3NfvRuhhupYoL4ZpwlCOvjafHp8Dcd6SDVWLrpImceH1hDOJkTZJroCqe9DrJ4isuUJIu0322yK5PWdnFsT7z7PZe0_m7u_bA7qQF1HI8PQNpVgkxl7zqhrMTtmpdVjMMqD9LRT6rpmSPdj9zCekCdCY_tNUuw32kC0Lm7iHfvdJV47dqA0dw8dqEOwxD7j7BDgHhcwgDDdX6nwPgth-8kC3k_y2O7t2XCLHYx9KNku8dpz4XuYoQ6_vXt6e1hIuosLS9_4wN3sZvpe4sb3QRqkoRuBzz6Rz4Bl8725TPaQUrGfntH9hJs-XOjY_k5hDxHHezOfPlxvO8LcfeLcnYt6RBw1cJ83wurBeyT2kNn9N-kRwjTUnGvcgTo1HHQPzvUkMwMMENmbvXsak-H7uZFzDVgOHcCnzUxt8DawvbnF93GKQ_RlI6kcLOQ7ptSXkL6oMlLz2E3zSBj96ThNwuimzFiT-aImohNW8-IZfYxW3yV8YHlpGiuZVDbvRT-aaaw9npo7B3ej6f6R-7P8KNVvTckL3bD5-uAyShJ9U-a2YS6SRutK2bny0EkexUoF5jUbu_DmUt-1lSbn8o80e6tfo1lP9UOadCF4Ug-0GywDOPPYkKkKPqZmVrtns8hV4-1j-QOmHyXDpt_mU_UwnYeyd68dgrU1Xu6xdYWXsfTVNI0DlTWFyfTfg1NezDyVQTCI0HZ4fbpwqV9qWWPw7fCmnbJ6R_sSh-4YZHm_evVKryUiYXTXeKCG5Qn28CnCLw9ZkmbB-oo42j3GwxezekvaQ7DqWxn3Y9461q69Mhu8jiSQu5sfD-Vh9dK0GtxhA4XoIXu7ROqZ3KsXtR949eJSFtOL8GgRmZ6FP43-D-341HU='

def run():
    pob_install = r'C:\Users\danyz\AppData\Roaming\Path of Building Community'
    pob_path = r'C:\Users\danyz\AppData\Roaming\Path of Building Community'  # or %ProgramData%\Path of Building` for installed version

    pob = PathOfBuilding(pob_path, pob_install)

    decode = base64.urlsafe_b64decode(test_code)
    xml_string = zlib.decompress(decode).decode('utf-8')

    print(xml_string)

    builds_path = pob.get_builds_dir()
    print("POB Builds:", builds_path)

    print('\nLoading build:')
    pprint(pob.load_build_code(xml_string))

    # time.sleep(2)
    pprint(pob.get_build_info())

    # print('\nUpdating build:')
    # pob.update_build()

    mod = "10% increased Intelligence"
    print('\nTesting single mod effects:', mod)
    pprint(pob.test_mod_effect(mod))

    print('\nGenerating HTML from item effects test: ./test-item1.html')
    Path('test-item1.html').write_text(pob.test_item_as_html(TEST_ITEM_1))

    print('\nFetch data directly from Lua:')
    print('  build.spec.curAscendClassName = ', end='')
    pprint(pob.fetch('build.spec.curAscendClassName'))

    # try:
    #     while True:
    #         user_string = input('>')
    #         print(pob._send(user_string))
    # except KeyboardInterrupt:
    #     pass

    # `pob` is killed automatically

    return pob


if __name__ == '__main__':
    pob = run()
